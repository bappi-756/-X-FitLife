<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - XfitLife</title>
    <link rel="icon" href="icons/x-fit.ico">
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6c40c0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="X-fitLife">
    <link rel="apple-touch-icon" href="icons/x-fit.png">
    <link rel="manifest" href="manifest.json">
    <!-- End PWA Meta Tags -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="settings.css">
</head>
<body>
    <div class="settings-container">
        <!-- Header -->
        <header class="settings-header">
            <div class="header-left">
                <a class="back-button" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <h1>Profile</h1>
            </div>
            <div class="header-right">
                <div class="app-logo" onclick="window.location.href='index.html'">
                    <img src="icons/x-fit.png" alt="XfitLife Logo" height="35">
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="settings-content">
            <!-- Profile Section -->
            <div class="profile-section">
                <div class="profile-image-container">
                    <div class="profile-image" id="profileImage">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-completion">
                        <svg class="progress-ring" viewBox="0 0 140 140" width="100%" height="100%">
                            <circle 
                                class="progress-ring-circle" 
                                stroke="#6c40c0" 
                                stroke-width="8" 
                                fill="transparent" 
                                r="60" 
                                cx="70" 
                                cy="70"
                            />
                        </svg>
                    </div>
                    <label for="imageUpload" class="image-upload-btn">
                        <i class="fas fa-camera"></i>
                    </label>
                    <input type="file" id="imageUpload" accept="image/*" style="display: none">
                </div>

                <div class="profile-info">
                    <h2 style="display: none;" id="profileName">Loading...</h2>
                    <div class="user-details">
                        <div class="detail-item">
                            <i class="fas fa-user"></i>
                            <span id="profileUsername">Loading...</span>
                            <button class="edit-btn" id="editProfileUsername">
                                <i class="fas fa-pen"></i>
                            </button>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-envelope"></i>
                            <span id="profileEmail">Loading...</span>
                        <!--   <button class="edit-btn" id="editProfileEmail">
                                <i class="fas fa-pen"></i>
                            </button> -->
                        </div>
                    </div>
                    <div class="chat-status" onclick="window.open('https://bappi5.netlify.app/', '_blank')">
                        <span class="status-dot"></span>
                        <span>support Developer</span>
                    </div>
                </div>
            </div>

            <!-- Personality Question Button -->
            <div class="personality-question-btn" id="personalityQuestionBtn" onclick="openPersonalityTest()">
                <div class="question-icon">
                    <i class="	fa fa-asterisk" style="color: var(--text-color);"></i>
                </div>
                <div class="question-content">
                    <h3>Are you an introvert or an extrovert?</h3>
                    <p id="personalityResultPreview">Take a quick test to find out</p>
                </div>
                <i class="fas fa-chevron-right"></i>
            </div>

            <!-- Theme Toggle -->
            <div class="theme-toggle-container">
                <h3>App Theme</h3>
                <div class="theme-toggle-wrapper">
                    <div class="theme-option" id="lightTheme">
                        <div class="theme-icon light-icon">
                            <i class="fas fa-sun"></i>
                        </div>
                        <span>Light</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="themeToggle">
                        <span class="slider round"></span>
                    </label>
                    <div class="theme-option" id="darkTheme">
                        <div class="theme-icon dark-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <span>Dark</span>
                    </div>
                </div>
            </div>
            
            <!-- System Version Info -->
            <div class="system-info-container" style="background-color: var(--card-background); border-radius: 15px 15px 0px 0px; padding: 15px; margin-top: 20px; border: 1px solid var(--border-color);">
                <h3 style="font-size: 1.1rem; margin: 0 0 10px 0; color: var(--text-color); background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">System Information</h3>
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color: var(--text-color-light); background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">Version</span>
                    <span style="color: var(--text-color); font-weight: 500; background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">1.2025.4.0 Beta</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color: var(--text-color-light); background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">Build Date</span>
                    <span style="color: var(--text-color); background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">April 29, 2025</span>
                </div>
                <div style="margin-top: 15px; padding: 10px; background-color: rgba(108, 64, 192, 0.1); border-radius: 8px;">
                    <p style="margin: 0; color: var(--text-color); font-size: 0.9rem; line-height: 1.5;">
                        <i class="fas fa-info-circle" style="color: var(--primary-color); margin-right: 5px;"></i>
                        This system is still in beta. You may encounter some glitches, but we're actively working on improvements for better experience in future updates.
                    </p>
                    <p style="margin: 0; color: var(--text-color); font-size: 0.9rem; line-height: 1.5;">any problem report please contact <a href="https://bappi5.netlify.app/" target="_blank" style="color: var(--text-color); background-color: rgba(108, 64, 192, 0.1); padding: 5px; border-radius: 5px;">support Developer</a></p>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="index.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="explore.html" class="nav-item">
                <i class="fas fa-search"></i>
                <span>Explore</span>
            </a>
            <a href="ask.html" class="nav-item">
                <i class="fas fa-brain"></i>
                <span>Ask</span>
            </a>
            <a href="notes.html" class="nav-item">
                <i class="fas fa-clipboard-list"></i>
                <span>Notes</span>
            </a>
            <div class="nav-item active">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </nav>
    </div>

    <!-- Personality Test Popup -->
    <div class="personality-test-popup" id="personalityTestPopup">
        <div class="popup-header">
            <h2>Personality Test</h2>
            <button class="close-popup" id="closePersonalityPopup">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="popup-content">
            <div class="question-container">
                <div class="question-counter">Question <span id="currentQuestion">1</span>/10</div>
                <div class="question-text" id="questionText">Loading question...</div>
                <div class="answer-options">
                    <button class="answer-btn" data-score="1">Strongly Disagree</button>
                    <button class="answer-btn" data-score="2">Disagree</button>
                    <button class="answer-btn" data-score="3">Neutral</button>
                    <button class="answer-btn" data-score="4">Agree</button>
                    <button class="answer-btn" data-score="5">Strongly Agree</button>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="testProgressBar"></div>
                </div>
            </div>

            <div class="result-container" id="resultContainer" style="display: none;">
                <div class="result-icon">
                    <i class="fas fa-user-circle"></i>
                </div>
                <h2>Your Result</h2>
                <div class="personality-type" id="personalityType"></div>
                <div class="personality-description" id="personalityDescription"></div>
                <button class="restart-test-btn" id="restartTestBtn">Take Test Again</button>
            </div>
        </div>
    </div>

    <script src="settings.js"></script>
    
    <script>
        // Check if user already has a personality type on page load
        document.addEventListener('DOMContentLoaded', function() {
            const userData = JSON.parse(localStorage.getItem('xfitUser'));
            const personalityPreview = document.getElementById('personalityResultPreview');
            
            if (userData && userData.personalityType && personalityPreview) {
                personalityPreview.textContent = `Your type: ${userData.personalityType}`;
                personalityPreview.classList.add('has-result');
            }
        });
        
        // Standalone functions for personality test
        function openPersonalityTest() {
            console.log('Opening personality test (global function)');
            const popup = document.getElementById('personalityTestPopup');
            popup.style.display = 'flex';
            popup.classList.add('active');
            
            // Initialize the test
            initializeTest();
        }
        
        function initializeTest() {
            const questions = [
                "I enjoy being the center of attention.",
                "I prefer one-on-one conversations to group activities.",
                "I feel energized after spending time with a lot of people.",
                "I need time alone to recharge after social situations.",
                "I tend to think before I speak.",
                "I enjoy meeting new people and making new friends easily.",
                "I prefer to work alone rather than in a team.",
                "I'm usually the one who initiates conversations.",
                "I find it draining to be in social situations for long periods.",
                "I get my energy from being around other people."
            ];
            
            // Set the first question
            const questionText = document.getElementById('questionText');
            const currentQuestionEl = document.getElementById('currentQuestion');
            
            if (questionText) {
                questionText.textContent = questions[0];
                currentQuestionEl.textContent = '1';
            }
            
            // Reset progress bar
            const progressBar = document.getElementById('testProgressBar');
            if (progressBar) {
                progressBar.style.width = '10%';
            }
            
            // Make sure question container is visible and result is hidden
            const questionContainer = document.querySelector('.question-container');
            const resultContainer = document.getElementById('resultContainer');
            
            if (questionContainer && resultContainer) {
                questionContainer.style.display = 'block';
                resultContainer.style.display = 'none';
            }
            
            // Set up answer buttons
            setupAnswerButtons(questions);
        }
        
        function setupAnswerButtons(questions) {
            let currentQuestion = 0;
            let score = 0;
            const extrovertQuestions = [0, 2, 5, 7, 9];
            
            const answerBtns = document.querySelectorAll('.answer-btn');
            const questionText = document.getElementById('questionText');
            const currentQuestionEl = document.getElementById('currentQuestion');
            const progressBar = document.getElementById('testProgressBar');
            const questionContainer = document.querySelector('.question-container');
            const resultContainer = document.getElementById('resultContainer');
            const personalityPreview = document.getElementById('personalityResultPreview');
            
            // Remove any existing event listeners
            answerBtns.forEach(btn => {
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
            });
            
            // Add new event listeners
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const scoreValue = parseInt(this.getAttribute('data-score'));
                    console.log('Answer clicked:', scoreValue, 'for question:', currentQuestion);
                    
                    // Calculate score based on question type
                    if (extrovertQuestions.includes(currentQuestion)) {
                        score += scoreValue;
                    } else {
                        score += (6 - scoreValue);
                    }
                    
                    // Move to next question or show result
                    currentQuestion++;
                    if (currentQuestion < questions.length) {
                        // Update question
                        questionText.textContent = questions[currentQuestion];
                        currentQuestionEl.textContent = currentQuestion + 1;
                        
                        // Update progress bar
                        const progressPercent = ((currentQuestion + 1) / questions.length) * 100;
                        progressBar.style.width = progressPercent + '%';
                    } else {
                        // Show result
                        questionContainer.style.display = 'none';
                        resultContainer.style.display = 'block';
                        
                        // Calculate personality type
                        const maxScore = questions.length * 5;
                        const scorePercentage = (score / maxScore) * 100;
                        
                        let result, description;
                        if (scorePercentage >= 70) {
                            result = "Extrovert";
                            description = "You are a strong extrovert! You get your energy from being around other people and enjoy social activities. You're outgoing, talkative, and comfortable in group settings. You think out loud and enjoy being the center of attention.";
                        } else if (scorePercentage >= 55) {
                            result = "Mild Extrovert";
                            description = "You lean towards extroversion. You generally enjoy social activities and being around people, though you may sometimes need alone time to recharge. You're comfortable in groups but also value meaningful one-on-one connections.";
                        } else if (scorePercentage >= 45) {
                            result = "Ambivert";
                            description = "You are an ambivert, with a good balance of both introverted and extroverted traits. You can adapt to various social situations and enjoy both social time and alone time. You have the best of both worlds!";
                        } else if (scorePercentage >= 30) {
                            result = "Mild Introvert";
                            description = "You lean towards introversion. You enjoy meaningful conversations and close relationships, but large groups or prolonged social interaction may drain your energy. You value your alone time and use it to recharge.";
                        } else {
                            result = "Introvert";
                            description = "You are a strong introvert! You gain energy from solitude and quiet reflection. You prefer deep one-on-one conversations to large group settings. You think before you speak and value meaningful connections over casual acquaintances.";
                        }
                        
                        document.getElementById('personalityType').textContent = result;
                        document.getElementById('personalityDescription').textContent = description;
                        
                        // Update the preview text in the button
                        if (personalityPreview) {
                            personalityPreview.textContent = `Your type: ${result}`;
                            personalityPreview.classList.add('has-result');
                        }
                        
                        // Save to local storage if user data exists
                        const userData = JSON.parse(localStorage.getItem('xfitUser'));
                        if (userData) {
                            userData.personalityType = result;
                            localStorage.setItem('xfitUser', JSON.stringify(userData));
                        }
                    }
                });
            });
            
            // Set up close button
            const closeBtn = document.getElementById('closePersonalityPopup');
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    document.getElementById('personalityTestPopup').classList.remove('active');
                    document.getElementById('personalityTestPopup').style.display = 'none';
                });
            }
            
            // Set up restart button
            const restartBtn = document.getElementById('restartTestBtn');
            if (restartBtn) {
                restartBtn.addEventListener('click', function() {
                    currentQuestion = 0;
                    score = 0;
                    
                    questionText.textContent = questions[0];
                    currentQuestionEl.textContent = '1';
                    progressBar.style.width = '10%';
                    
                    questionContainer.style.display = 'block';
                    resultContainer.style.display = 'none';
                });
            }
        }
    </script>
</body>
</html> 